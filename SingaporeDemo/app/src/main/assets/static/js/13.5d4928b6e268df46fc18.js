webpackJsonp([13],{"/Ryc":function(t,e){},"Sya/":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("Xxa5"),r=n.n(s),a=n("exGp"),o=n.n(a),i=(n("GKy3"),n("4vvA")),c=n.n(i),u=n("uotZ"),m=n("h496"),l=n("//Fk"),f=n.n(l),d=n("mF0L"),g=n("bG0Y"),p=n("c5/C"),h=n("lqT0"),v=n("ahwU"),y={mixins:[p.jNodeConfig],methods:{confirmSubmit:function(t){var e=this;return o()(r.a.mark(function n(){var s,a,o;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=new h.JcWalletTool(e.jcWallet),a=!0,o=null,n.prev=3,n.next=6,s.validatePassword(t,"swt");case 6:o=n.sent,n.next=13;break;case 9:return n.prev=9,n.t0=n.catch(3),c.a.fail(e.$t("message.transferPayment.passwordWrong")),n.abrupt("return");case 13:return n.abrupt("return",new f.a(function(t,n){Object(g.createOrder)({counter:e.currencyPairs.counter,base:e.currencyPairs.base,issuer:"jGa9J9TkqtBcUoHe2zqhVFFbgUVED6o9or",address:e.publicKey,secret:o,type:e.type,amount:e.getAmount,sum:e.sum,hosts:a?e.exHosts:[window.location.hostname],port:a?e.exPort:"8080",https:e.https}).then(function(){return c.a.success(e.$t("message.transferPayment.successCreateOrder")),t()}).catch(function(t){return n(t)})}));case 14:case"end":return n.stop()}},n,e,[[3,9]])}))()},getBaseName:function(t){return"CNT"===t?"CNY":"SWTC"===t?"SWT":t},orderWithtradePsw:function(t){var e=this;if(!this.isValidAddress(this.form.walletAddress))return c.a.fail(this.$t("message.transferPayment.toAddressVaild")),void this.clearInput();var n=new h.JcWalletTool(this.jcWallet),s=this.exHosts,r=this.exPort;n.validatePassword(this.form.tradePsw,"swt").then(function(n){var a={issuer:"jGa9J9TkqtBcUoHe2zqhVFFbgUVED6o9or"};a.currency=t,a.address=e.publicKey,a.to=e.form.walletAddress,a.amount=e.form.inputTargetCount,a.memo=e.form.purpose,a.secret=n,a.hosts=s,a.port=r,a.https=e.https,setTimeout(function(){e.confirmTransfer(a)},1e3)}).catch(function(t){c.a.fail(t.message)}).finally(function(){})},confirmTransfer:function(t){var e=this;console.log("开始转账"),console.log(t),Object(g.transferAccount)(t).then(function(){c.a.success(e.$t("message.transferPayment.finishAgiotage"))}).catch(function(t){console.log(t.message),c.a.fail(t.message)})},isValidAddress:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"swt";return v.Wallet.isValidAddress(t,e)}},computed:{sum:function(){var t=new u.BigNumber(this.form.price).decimalPlaces(3).toNumber(),e=this.form.inputTargetCount,n=this.form.amount,s=0;return 0===this.type?Object(d.e)(parseFloat(t))&&Object(d.e)(parseFloat(e))&&(s=new u.BigNumber(e).decimalPlaces(6).multipliedBy(t).decimalPlaces(6).toNumber()):1===this.type&&Object(d.e)(parseFloat(t))&&Object(d.e)(parseFloat(n))&&(s=new u.BigNumber(n).decimalPlaces(6).multipliedBy(t).decimalPlaces(6).toNumber()),s},getAmount:function(){return 0===this.type?this.form.inputTargetCount:1===this.type?this.form.amount:void 0},publicKey:function(){return this.$store.getters.swtAddress},jcWallet:function(){return this.$store.getters.jcWallet}}},b=n("mL9E"),P={name:"agiotage",components:{JcSelect:m.default},mixins:[y],data:function(){return{selectedHolding:!0,choosingPurpose:!1,confirmDialog:!1,form:{amount:0,inputTargetCount:"",tradePsw:"",payeeName:"",walletAddress:"",purpose:this.$t("message.transferPayment.overseasInvestment")},base:"CNT",baseChoosing:!1,counter:"EGP",counterChoosing:!1,type:0,purposeList:[{name:this.$t("message.transferPayment.overseasInvestment")},{name:this.$t("message.transferPayment.crossBorderTransfer")},{name:this.$t("message.transferPayment.crossBorderPayment")}],currencyList:[],currencyPairs:{base:"",counter:""}}},props:{userName:{type:String,default:""},address:{type:String,default:""}},created:function(){this.form.payeeName=this.userName,this.form.walletAddress=this.address},mounted:function(){var t=this;this.form.amount=1e3,this.form.inputTargetCount=this.getAmountOfConvert,setTimeout(function(){t.getCurrencyListList()},300)},methods:{confirmPay:function(){var t=this;this.confirmDialog=!1,this.checkInput&&!this.loading&&(this.loading=!0,c.a.loading({duration:0,forbidClick:!0,message:this.$t("message.transferPayment.exchangeing")}),this.confirmSubmit(this.form.tradePsw).then(function(){setTimeout(function(){c.a.loading({duration:0,forbidClick:!0,message:t.$t("message.transferPayment.transfering")})},2500),setTimeout(function(){t.checkBalance(t.counter,t.form.inputTargetCount)},12500)}).catch(function(e){console.log(e),t.clearInput()}))},checkBalance:function(t,e){var n=this;return o()(r.a.mark(function s(){var a,o,i;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=n.getBaseName(t),console.log("balance-coin="+a,"balance-amount="+e),console.log("balance-addr="+n.publicKey),s.next=5,Object(b.a)(n.publicKey);case 5:o=s.sent,i=!1,Array.isArray(o.data)&&o.data.length>0?(o.data.forEach(function(t){t.currency===a&&parseFloat(t.value)>=parseFloat(e)&&(i=!0)}),i?(console.log("资产够了"),n.orderWithtradePsw(a)):(console.log("资产不够"),c()(n.$t("message.transferPayment.autoTransferFialed")))):c()(n.$t("message.transferPayment.autoTransferFialed"));case 8:case"end":return s.stop()}},s,n)}))()},toContact:function(){this.$router.push({path:"/contact",query:{currentShow:"agiotage"}})},waitPayment:function(){},holdingInputChange:function(t){var e=t.target.value;!e||""===e||e<=0||(this.form.inputTargetCount=new u.BigNumber(this.getAmountOfConvert).decimalPlaces(5).toNumber())},holdingInputBlur:function(){var t=this.form.amount;(!t||t<=0||""===t)&&(this.form.amount=this.getAmountByConvertCount)},targetInputChange:function(t){var e=t.target.value;!e||""===e||e<=0||(this.form.amount=new u.BigNumber(this.getAmountByConvertCount).decimalPlaces(5).toNumber())},targetInputBlur:function(){var t=this.form.inputTargetCount;(!t||t<=0||""===t)&&(this.form.inputTargetCount=this.getAmountOfConvert)},getCurrencyListList:function(){var t=this,e=this.coinList;Array.isArray(e)&&e.length>0&&e.forEach(function(e){t.currencyList.push({name:e.label,icon:"currency-icon-"+e.label})})},clearInput:function(){this.form.tradePsw="",this.loading=!1}},computed:{coinList:function(){return this.$store.getters.coins},getTrandeCostPrice:function(){return new u.BigNumber(.01)},getAmountOfConvert:function(){var t=this.form.amount;if(""!==t&&t>0)return new u.BigNumber(this.form.amount).multipliedBy(new u.BigNumber(this.currentRatePrice)).decimalPlaces(3).toNumber()},getAmountByConvertCount:function(){var t=this.form.inputTargetCount;if(""!==t&&t>0)return new u.BigNumber(this.form.inputTargetCount).dividedBy(this.currentRatePrice).decimalPlaces(3).toNumber()},getReceivableAmount:function(){return new u.BigNumber(this.getAmountOfConvert).decimalPlaces(3).toNumber()},currentRatePrice:function(){var t=1;return"CNT"===this.base?(this.currencyPairs.counter="CNY",this.currencyPairs.base=this.counter):"CNT"===this.counter&&(this.currencyPairs.counter="CNY",this.currencyPairs.base=this.base),this.base===this.counter?(this.type=-1,t=new u.BigNumber(1).decimalPlaces(3).toNumber()):"CNT"===this.base&&"EGP"===this.counter?(this.type=0,this.form.price=new u.BigNumber(.389).decimalPlaces(3).toNumber(),t=new u.BigNumber(1).dividedBy(new u.BigNumber(.389)).decimalPlaces(3).toNumber()):"EGP"===this.base&&"CNT"===this.counter&&(this.type=1,this.form.price=new u.BigNumber(.388).decimalPlaces(3).toNumber(),t=new u.BigNumber(.388).decimalPlaces(3).toNumber()),console.log("type="+this.type),console.log("price="+this.form.price),console.log("sum="+this.sum),console.log("pairs=",this.currencyPairs),t},getTradeCostRate:function(){return new u.BigNumber(.005).decimalPlaces(5).toNumber()},checkInput:function(){return this.form.amount>0&&this.form.price>0&&this.form.inputTargetCount>0&&""!==this.form.payeeName&&""!==this.form.walletAddress&&""!==this.form.purpose&&""!==this.base&&""!==this.counter}},watch:{currentRatePrice:function(t){this.form.inputTargetCount=this.getAmountOfConvert}}},C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"agiotage"}},[n("ul",{staticClass:"selectTarget"},[n("li",{class:{selectedHolding:!1},on:{click:function(e){t.selectedHolding=!0}}},[t._v(t._s(t.$t("message.transferPayment.HoldingCurrency")))]),t._v(" "),n("li",{class:{selectedHolding:!1},on:{click:function(e){t.selectedHolding=!1}}},[t._v(t._s(t.$t("message.transferPayment.TargetCurrency")))])]),t._v(" "),n("ul",{staticClass:"selectCurrency"},[n("li",{on:{click:function(e){t.baseChoosing=!t.baseChoosing,t.counterChoosing=!1}}},[n("i",{class:"currency-icon-"+t.base}),t._v(" "),n("span",[t._v(t._s(t.base))]),t._v(" "),n("i",{class:"triangle_"+(t.baseChoosing?"clicked":"default")})]),t._v(" "),n("li",{on:{click:function(e){t.counterChoosing=!t.counterChoosing,t.baseChoosing=!1}}},[n("i",{class:"currency-icon-"+t.counter}),t._v(" "),n("span",[t._v(t._s(t.counter))]),t._v(" "),n("i",{class:"triangle_"+(t.counterChoosing?"clicked":"default")})])]),t._v(" "),n("div",{staticStyle:{display:"flex"}},[n("div",{staticStyle:{position:"relative",width:"50%"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.baseChoosing,expression:"baseChoosing"}],staticStyle:{position:"absolute",top:"100%",left:"50%","margin-left":"-0.95rem","margin-top":"-0.15rem"}},[n("JcSelect",{attrs:{data:t.currencyList,align:"left",width:"1.9rem",borderColor:"#559df7",itemSpacing:"0.1rem",fontSize:"0.30rem"},on:{close:function(e){t.baseChoosing=!1}},model:{value:t.base,callback:function(e){t.base=e},expression:"base"}})],1)]),t._v(" "),n("div",{staticStyle:{position:"relative",width:"50%"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.counterChoosing,expression:"counterChoosing"}],staticStyle:{position:"absolute",top:"100%",left:"50%","margin-left":"-0.95rem","margin-top":"-0.15rem"}},[n("JcSelect",{attrs:{data:t.currencyList,align:"left",width:"1.9rem",borderColor:"#559df7",itemSpacing:"0.1rem",fontSize:"0.30rem"},on:{close:function(e){t.counterChoosing=!1}},model:{value:t.counter,callback:function(e){t.counter=e},expression:"counter"}})],1)])]),t._v(" "),n("div",{staticClass:"amountInput"},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.amount,expression:"form.amount"}],attrs:{type:"number"},domProps:{value:t.form.amount},on:{input:[function(e){e.target.composing||t.$set(t.form,"amount",e.target.value)},t.holdingInputChange],focus:function(e){t.form.amount=""},blur:t.holdingInputBlur}})]),t._v(" "),n("p",{staticStyle:{height:"78%",border:"0.015rem solid #e0e3e8"}}),t._v(" "),n("div",{staticStyle:{"justify-content":"flex-end"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.inputTargetCount,expression:"form.inputTargetCount"}],staticStyle:{"text-align":"right"},attrs:{type:"number"},domProps:{value:t.form.inputTargetCount},on:{input:[function(e){e.target.composing||t.$set(t.form,"inputTargetCount",e.target.value)},t.targetInputChange],focus:function(e){t.form.inputTargetCount=""},blur:t.targetInputBlur}})])]),t._v(" "),n("ul",{staticClass:"exchangeRate"},[n("li",{staticStyle:{"justify-content":"flex-end"}},[t._v(t._s(t.$t("message.transferPayment.exchangeRate"))+"：")]),t._v(" "),n("li",{staticStyle:{"min-width":"30%","background-color":"#e8eaf0",padding:"0.05rem 0","border-radius":"0.1rem","text-indent":"0.2rem",color:"#4d4d4d"}},[t._v(t._s(t.currentRatePrice))]),t._v(" "),n("li",{staticStyle:{"border-radius":"0.22rem",color:"#fff","background-color":"#559df7","margin-left":"0.2rem",padding:"0.04rem 0.1rem","justify-content":"center"}},[t._v(t._s(t.$t("message.transferPayment.exchangeRateCompare")))])]),t._v(" "),n("ol",{staticClass:"transactionSummary"},[n("li",{staticStyle:{color:"#555b61","justify-content":"center"}},[t._v(t._s(t.$t("message.transferPayment.transactionSummary")))]),t._v(" "),n("li",[n("span",[t._v(t._s(t.$t("message.transferPayment.remittanceAmount")))]),t._v(" "),n("span",[t._v(t._s(t.form.amount||0)+" "),n("span",{staticClass:"monoSpace"},[t._v(t._s(t.base))])])]),t._v(" "),n("li",[n("span",[t._v(t._s(t.$t("message.transferPayment.transactionCost")))]),t._v(" "),n("span",[t._v(t._s(t.getTrandeCostPrice||0)),n("span",{staticClass:"monoSpace"},[t._v(t._s("SWTC"))])])]),t._v(" "),n("li",[n("span",[t._v(t._s(t.$t("message.transferPayment.amountOfConversion")))]),t._v(" "),n("span",[t._v(t._s(t.getAmountOfConvert||0)+" "),n("span",{staticClass:"monoSpace"},[t._v(t._s(t.counter))])])]),t._v(" "),n("li",[n("span",[t._v(t._s(t.$t("message.transferPayment.receivableAmount")))]),t._v(" "),n("span",[t._v(t._s(t.getReceivableAmount||0)+" "),n("span",{staticClass:"monoSpace"},[t._v(t._s(t.counter))])])])]),t._v(" "),n("ol",{staticClass:"inputInformation"},[n("li",{staticStyle:{width:"100%",position:"relative"}},[n("label",[t._v(t._s(t.$t("message.transferPayment.payee"))+"：")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.payeeName,expression:"form.payeeName"}],staticStyle:{"margin-right":"0.2rem"},attrs:{type:"text"},domProps:{value:t.form.payeeName},on:{input:function(e){e.target.composing||t.$set(t.form,"payeeName",e.target.value)}}}),t._v(" "),n("i",{staticClass:"contacts_icon positionIcon",staticStyle:{"margin-top":"-0.15rem",right:"0.5rem"},on:{click:t.toContact}}),t._v(" "),n("i",{staticClass:"scanning_icon",staticStyle:{"min-width":"0.32rem"}})]),t._v(" "),n("li",{staticStyle:{"align-items":"flex-start"}},[n("label",{staticStyle:{"margin-top":"0.1rem"}},[t._v(t._s(t.$t("message.transferPayment.walletAddress"))+"：")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.walletAddress,expression:"form.walletAddress"}],staticStyle:{width:"100%",height:"0.9rem",padding:"0.1rem 0","vertical-align":"middle",outline:"none"},domProps:{value:t.form.walletAddress},on:{input:function(e){e.target.composing||t.$set(t.form,"walletAddress",e.target.value)}}})]),t._v(" "),n("li",[n("label",{staticStyle:{"margin-top":"0.1rem"}},[t._v(t._s(t.$t("message.transferPayment.purpose"))+"：")]),t._v(" "),n("div",{staticStyle:{position:"relative",width:"100%"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.purpose,expression:"form.purpose"}],staticStyle:{width:"100%"},attrs:{type:"text"},domProps:{value:t.form.purpose},on:{input:function(e){e.target.composing||t.$set(t.form,"purpose",e.target.value)}}}),t._v(" "),n("div",{staticStyle:{position:"absolute",top:"0",right:"0",width:"0.8rem",height:"0.7rem"},on:{click:function(e){t.choosingPurpose=!t.choosingPurpose}}},[n("i",{staticClass:"blackArrow_icon positionIcon",style:{"margin-top":t.choosingPurpose?"-0.1rem":"-0.12rem",transform:t.choosingPurpose?"rotate(90deg)":"rotate(0deg)"}})]),t._v(" "),n("div",{staticStyle:{width:"100%",position:"absolute",top:"0.9rem",left:"0","z-index":"1"}},[n("JcSelect",{directives:[{name:"show",rawName:"v-show",value:t.choosingPurpose,expression:"choosingPurpose"}],staticStyle:{color:"#616569"},attrs:{data:t.purposeList,width:"100%",borderColor:"#559df7",align:"left",fontSize:"0.28rem"},on:{close:function(e){t.choosingPurpose=!1}},model:{value:t.form.purpose,callback:function(e){t.$set(t.form,"purpose",e)},expression:"form.purpose"}})],1)])]),t._v(" "),n("li",{staticStyle:{"justify-content":"center"}},[n("button",{staticClass:"confirmBtn",class:{confirm_Btn:t.checkInput},on:{click:function(e){t.confirmDialog=!0}}},[t._v(t._s(t.$t("message.transferPayment.confirmPay")))])])]),t._v(" "),n("van-dialog",{staticStyle:{"margin-top":"-15%"},attrs:{"show-confirm-button":!1,title:t.$t("message.transferPayment.payments.inputPassword")},model:{value:t.confirmDialog,callback:function(e){t.confirmDialog=e},expression:"confirmDialog"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.tradePsw,expression:"form.tradePsw"}],staticClass:"inputPsw",staticStyle:{"margin-top":"0.1rem"},attrs:{type:"password",placeholder:t.$t("message.transferPayment.payments.inputPassword")},domProps:{value:t.form.tradePsw},on:{input:function(e){e.target.composing||t.$set(t.form,"tradePsw",e.target.value)}}}),t._v(" "),n("div",[n("button",{staticClass:"inputPsw",staticStyle:{margin:"0.4rem 0 0.2rem 0",background:"#409EFF",color:"#fff","font-size":"0.28rem"},on:{click:t.confirmPay}},[t._v(t._s(t.$t("message.transferPayment.comfirmAgiotagePay")))])])])],1)},staticRenderFns:[]};var _=n("VU/8")(P,C,!1,function(t){n("/Ryc")},"data-v-517bd4fc",null);e.default=_.exports}});
//# sourceMappingURL=13.5d4928b6e268df46fc18.js.map