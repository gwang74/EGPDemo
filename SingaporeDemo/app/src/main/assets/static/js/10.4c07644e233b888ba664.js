webpackJsonp([10],{"Sya/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("Xxa5"),r=n.n(s),a=n("exGp"),o=n.n(a),i=(n("GKy3"),n("4vvA")),c=n.n(i),u=n("uotZ"),m=n("h496"),l=n("//Fk"),f=n.n(l),d=n("mF0L"),g=n("bG0Y"),p=n("c5/C"),h=n("lqT0"),v=n("ahwU"),y={mixins:[p.jNodeConfig],methods:{confirmSubmit:function(e){var t=this;return o()(r.a.mark(function n(){var s,a,o;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=new h.JcWalletTool(t.jcWallet),a=!0,o=null,n.prev=3,n.next=6,s.validatePassword(e,"swt");case 6:o=n.sent,n.next=13;break;case 9:return n.prev=9,n.t0=n.catch(3),c.a.fail(t.$t("message.transferPayment.passwordWrong")),n.abrupt("return");case 13:return n.abrupt("return",new f.a(function(e,n){Object(g.createOrder)({counter:t.currencyPairs.counter,base:t.currencyPairs.base,issuer:"jGa9J9TkqtBcUoHe2zqhVFFbgUVED6o9or",address:t.publicKey,secret:o,type:t.type,amount:t.getAmount,sum:t.sum,hosts:a?t.exHosts:[window.location.hostname],port:a?t.exPort:"8080",https:t.https}).then(function(){return c.a.success(t.$t("message.transferPayment.successCreateOrder")),e()}).catch(function(e){return n(e)})}));case 14:case"end":return n.stop()}},n,t,[[3,9]])}))()},getBaseName:function(e){return"CNT"===e?"CNY":"SWTC"===e?"SWT":e},orderWithtradePsw:function(e){var t=this;if(!this.isValidAddress(this.form.walletAddress))return c.a.fail(this.$t("message.transferPayment.toAddressVaild")),void this.clearInput();var n=new h.JcWalletTool(this.jcWallet),s=this.exHosts,r=this.exPort;n.validatePassword(this.form.tradePsw,"swt").then(function(n){var a={issuer:"jGa9J9TkqtBcUoHe2zqhVFFbgUVED6o9or"};a.currency=e,a.address=t.publicKey,a.to=t.form.walletAddress,a.amount=t.form.inputTargetCount,a.memo=t.form.purpose,a.secret=n,a.hosts=s,a.port=r,a.https=t.https,setTimeout(function(){t.confirmTransfer(a)},1e3)}).catch(function(e){c.a.fail(e.message)}).finally(function(){})},confirmTransfer:function(e){var t=this;console.log("开始转账"),console.log(e),Object(g.transferAccount)(e).then(function(){c.a.success(t.$t("message.transferPayment.finishAgiotage"))}).catch(function(e){console.log(e.message),c.a.fail(e.message)})},isValidAddress:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"swt";return v.Wallet.isValidAddress(e,t)}},computed:{sum:function(){var e=new u.BigNumber(this.form.price).decimalPlaces(3).toNumber(),t=this.form.inputTargetCount,n=this.form.amount,s=0;return 0===this.type?Object(d.c)(parseFloat(e))&&Object(d.c)(parseFloat(t))&&(s=new u.BigNumber(t).decimalPlaces(6).multipliedBy(e).decimalPlaces(6).toNumber()):1===this.type&&Object(d.c)(parseFloat(e))&&Object(d.c)(parseFloat(n))&&(s=new u.BigNumber(n).decimalPlaces(6).multipliedBy(e).decimalPlaces(6).toNumber()),s},getAmount:function(){return 0===this.type?this.form.inputTargetCount:1===this.type?this.form.amount:void 0},publicKey:function(){return this.$store.getters.swtAddress},jcWallet:function(){return this.$store.getters.jcWallet}}},b=n("mL9E"),P={name:"agiotage",components:{JcSelect:m.default},mixins:[y],data:function(){return{selectedHolding:!0,choosingPurpose:!1,confirmDialog:!1,form:{amount:0,inputTargetCount:"",tradePsw:"",payeeName:"",walletAddress:"",purpose:this.$t("message.transferPayment.overseasInvestment")},base:"CNT",baseChoosing:!1,counter:"EGP",counterChoosing:!1,type:0,purposeList:[{name:this.$t("message.transferPayment.overseasInvestment")},{name:this.$t("message.transferPayment.crossBorderTransfer")},{name:this.$t("message.transferPayment.crossBorderPayment")}],currencyList:[],currencyPairs:{base:"",counter:""}}},mounted:function(){var e=this;this.form.amount=1e3,this.form.inputTargetCount=this.getAmountOfConvert,setTimeout(function(){e.getCurrencyListList()},300)},methods:{confirmPay:function(){var e=this;this.confirmDialog=!1,this.checkInput&&!this.loading&&(this.loading=!0,c.a.loading({duration:0,forbidClick:!0,message:this.$t("message.transferPayment.exchangeing")}),this.confirmSubmit(this.form.tradePsw).then(function(){setTimeout(function(){c.a.loading({duration:0,forbidClick:!0,message:e.$t("message.transferPayment.transfering")})},2500),setTimeout(function(){e.checkBalance(e.counter,e.form.inputTargetCount)},12500)}).catch(function(t){console.log(t),e.clearInput()}))},checkBalance:function(e,t){var n=this;return o()(r.a.mark(function s(){var a,o,i;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=n.getBaseName(e),console.log("balance-coin="+a,"balance-amount="+t),console.log("balance-addr="+n.publicKey),s.next=5,Object(b.a)(n.publicKey);case 5:o=s.sent,i=!1,Array.isArray(o.data)&&o.data.length>0?(o.data.forEach(function(e){e.currency===a&&parseFloat(e.value)>=parseFloat(t)&&(i=!0)}),i?(console.log("资产够了"),n.orderWithtradePsw(a)):(console.log("资产不够"),c()(n.$t("message.transferPayment.autoTransferFialed")))):c()(n.$t("message.transferPayment.autoTransferFialed"));case 8:case"end":return s.stop()}},s,n)}))()},waitPayment:function(){},holdingInputChange:function(e){var t=e.target.value;!t||""===t||t<=0||(this.form.inputTargetCount=new u.BigNumber(this.getAmountOfConvert).decimalPlaces(5).toNumber())},holdingInputBlur:function(){var e=this.form.amount;(!e||e<=0||""===e)&&(this.form.amount=this.getAmountByConvertCount)},targetInputChange:function(e){var t=e.target.value;!t||""===t||t<=0||(this.form.amount=new u.BigNumber(this.getAmountByConvertCount).decimalPlaces(5).toNumber())},targetInputBlur:function(){var e=this.form.inputTargetCount;(!e||e<=0||""===e)&&(this.form.inputTargetCount=this.getAmountOfConvert)},getCurrencyListList:function(){var e=this,t=this.coinList;Array.isArray(t)&&t.length>0&&t.forEach(function(t){e.currencyList.push({name:t.label,icon:"currency-icon-"+t.label})})},clearInput:function(){this.form.tradePsw="",this.loading=!1}},computed:{coinList:function(){return this.$store.getters.coins},getTrandeCostPrice:function(){return new u.BigNumber(.01)},getAmountOfConvert:function(){var e=this.form.amount;if(""!==e&&e>0)return new u.BigNumber(this.form.amount).multipliedBy(new u.BigNumber(this.currentRatePrice)).decimalPlaces(3).toNumber()},getAmountByConvertCount:function(){var e=this.form.inputTargetCount;if(""!==e&&e>0)return new u.BigNumber(this.form.inputTargetCount).dividedBy(this.currentRatePrice).decimalPlaces(3).toNumber()},getReceivableAmount:function(){return new u.BigNumber(this.getAmountOfConvert).decimalPlaces(3).toNumber()},currentRatePrice:function(){var e=1;return"CNT"===this.base?(this.currencyPairs.counter="CNY",this.currencyPairs.base=this.counter):"CNT"===this.counter&&(this.currencyPairs.counter="CNY",this.currencyPairs.base=this.base),this.base===this.counter?(this.type=-1,e=new u.BigNumber(1).decimalPlaces(3).toNumber()):"CNT"===this.base&&"EGP"===this.counter?(this.type=0,this.form.price=new u.BigNumber(.389).decimalPlaces(3).toNumber(),e=new u.BigNumber(1).dividedBy(new u.BigNumber(.389)).decimalPlaces(3).toNumber()):"EGP"===this.base&&"CNT"===this.counter&&(this.type=1,this.form.price=new u.BigNumber(.388).decimalPlaces(3).toNumber(),e=new u.BigNumber(.388).decimalPlaces(3).toNumber()),console.log("type="+this.type),console.log("price="+this.form.price),console.log("sum="+this.sum),console.log("pairs=",this.currencyPairs),e},getTradeCostRate:function(){return new u.BigNumber(.005).decimalPlaces(5).toNumber()},checkInput:function(){return this.form.amount>0&&this.form.price>0&&this.form.inputTargetCount>0&&""!==this.form.payeeName&&""!==this.form.walletAddress&&""!==this.form.purpose&&""!==this.base&&""!==this.counter}},watch:{currentRatePrice:function(e){this.form.inputTargetCount=this.getAmountOfConvert}}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"agiotage"}},[n("ul",{staticClass:"selectTarget"},[n("li",{class:{selectedHolding:!1},on:{click:function(t){e.selectedHolding=!0}}},[e._v(e._s(e.$t("message.transferPayment.HoldingCurrency")))]),e._v(" "),n("li",{class:{selectedHolding:!1},on:{click:function(t){e.selectedHolding=!1}}},[e._v(e._s(e.$t("message.transferPayment.TargetCurrency")))])]),e._v(" "),n("ul",{staticClass:"selectCurrency"},[n("li",{on:{click:function(t){e.baseChoosing=!e.baseChoosing,e.counterChoosing=!1}}},[n("i",{class:"currency-icon-"+e.base}),e._v(" "),n("span",[e._v(e._s(e.base))]),e._v(" "),n("i",{class:"triangle_"+(e.baseChoosing?"clicked":"default")})]),e._v(" "),n("li",{on:{click:function(t){e.counterChoosing=!e.counterChoosing,e.baseChoosing=!1}}},[n("i",{class:"currency-icon-"+e.counter}),e._v(" "),n("span",[e._v(e._s(e.counter))]),e._v(" "),n("i",{class:"triangle_"+(e.counterChoosing?"clicked":"default")})])]),e._v(" "),n("div",{staticStyle:{display:"flex"}},[n("div",{staticStyle:{position:"relative",width:"50%"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.baseChoosing,expression:"baseChoosing"}],staticStyle:{position:"absolute",top:"100%",left:"50%","margin-left":"-0.95rem","margin-top":"-0.15rem"}},[n("JcSelect",{attrs:{data:e.currencyList,align:"left",width:"1.9rem",borderColor:"#559df7",itemSpacing:"0.1rem",fontSize:"0.30rem"},on:{close:function(t){e.baseChoosing=!1}},model:{value:e.base,callback:function(t){e.base=t},expression:"base"}})],1)]),e._v(" "),n("div",{staticStyle:{position:"relative",width:"50%"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.counterChoosing,expression:"counterChoosing"}],staticStyle:{position:"absolute",top:"100%",left:"50%","margin-left":"-0.95rem","margin-top":"-0.15rem"}},[n("JcSelect",{attrs:{data:e.currencyList,align:"left",width:"1.9rem",borderColor:"#559df7",itemSpacing:"0.1rem",fontSize:"0.30rem"},on:{close:function(t){e.counterChoosing=!1}},model:{value:e.counter,callback:function(t){e.counter=t},expression:"counter"}})],1)])]),e._v(" "),n("div",{staticClass:"amountInput"},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.amount,expression:"form.amount"}],attrs:{type:"number"},domProps:{value:e.form.amount},on:{input:[function(t){t.target.composing||e.$set(e.form,"amount",t.target.value)},e.holdingInputChange],focus:function(t){e.form.amount=""},blur:e.holdingInputBlur}})]),e._v(" "),n("p",{staticStyle:{height:"78%",border:"0.015rem solid #e0e3e8"}}),e._v(" "),n("div",{staticStyle:{"justify-content":"flex-end"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.inputTargetCount,expression:"form.inputTargetCount"}],staticStyle:{"text-align":"right"},attrs:{type:"number"},domProps:{value:e.form.inputTargetCount},on:{input:[function(t){t.target.composing||e.$set(e.form,"inputTargetCount",t.target.value)},e.targetInputChange],focus:function(t){e.form.inputTargetCount=""},blur:e.targetInputBlur}})])]),e._v(" "),n("ul",{staticClass:"exchangeRate"},[n("li",{staticStyle:{"justify-content":"flex-end"}},[e._v(e._s(e.$t("message.transferPayment.exchangeRate"))+"：")]),e._v(" "),n("li",{staticStyle:{"min-width":"30%","background-color":"#e8eaf0",padding:"0.05rem 0","border-radius":"0.1rem","text-indent":"0.2rem",color:"#4d4d4d"}},[e._v(e._s(e.currentRatePrice))]),e._v(" "),n("li",{staticStyle:{"border-radius":"0.22rem",color:"#fff","background-color":"#559df7","margin-left":"0.2rem",padding:"0.04rem 0.1rem","justify-content":"center"}},[e._v(e._s(e.$t("message.transferPayment.exchangeRateCompare")))])]),e._v(" "),n("ol",{staticClass:"transactionSummary"},[n("li",{staticStyle:{color:"#555b61","justify-content":"center"}},[e._v(e._s(e.$t("message.transferPayment.transactionSummary")))]),e._v(" "),n("li",[n("span",[e._v(e._s(e.$t("message.transferPayment.remittanceAmount")))]),e._v(" "),n("span",[e._v(e._s(e.form.amount||0)+" "),n("span",{staticClass:"monoSpace"},[e._v(e._s(e.base))])])]),e._v(" "),n("li",[n("span",[e._v(e._s(e.$t("message.transferPayment.transactionCost")))]),e._v(" "),n("span",[e._v(e._s(e.getTrandeCostPrice||0)),n("span",{staticClass:"monoSpace"},[e._v(e._s("SWTC"))])])]),e._v(" "),n("li",[n("span",[e._v(e._s(e.$t("message.transferPayment.amountOfConversion")))]),e._v(" "),n("span",[e._v(e._s(e.getAmountOfConvert||0)+" "),n("span",{staticClass:"monoSpace"},[e._v(e._s(e.counter))])])]),e._v(" "),n("li",[n("span",[e._v(e._s(e.$t("message.transferPayment.receivableAmount")))]),e._v(" "),n("span",[e._v(e._s(e.getReceivableAmount||0)+" "),n("span",{staticClass:"monoSpace"},[e._v(e._s(e.counter))])])])]),e._v(" "),n("ol",{staticClass:"inputInformation"},[n("li",{staticStyle:{width:"100%",position:"relative"}},[n("label",[e._v(e._s(e.$t("message.transferPayment.payee"))+"：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.payeeName,expression:"form.payeeName"}],staticStyle:{"margin-right":"0.2rem"},attrs:{type:"text"},domProps:{value:e.form.payeeName},on:{input:function(t){t.target.composing||e.$set(e.form,"payeeName",t.target.value)}}}),e._v(" "),n("i",{staticClass:"contacts_icon positionIcon",staticStyle:{"margin-top":"-0.15rem",right:"0.5rem"}}),e._v(" "),n("i",{staticClass:"scanning_icon",staticStyle:{"min-width":"0.32rem"}})]),e._v(" "),n("li",{staticStyle:{"align-items":"flex-start"}},[n("label",{staticStyle:{"margin-top":"0.1rem"}},[e._v(e._s(e.$t("message.transferPayment.walletAddress"))+"：")]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.walletAddress,expression:"form.walletAddress"}],staticStyle:{width:"100%",height:"0.9rem",padding:"0.1rem 0","vertical-align":"middle",outline:"none"},domProps:{value:e.form.walletAddress},on:{input:function(t){t.target.composing||e.$set(e.form,"walletAddress",t.target.value)}}})]),e._v(" "),n("li",[n("label",{staticStyle:{"margin-top":"0.1rem"}},[e._v(e._s(e.$t("message.transferPayment.purpose"))+"：")]),e._v(" "),n("div",{staticStyle:{position:"relative",width:"100%"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.purpose,expression:"form.purpose"}],staticStyle:{width:"100%"},attrs:{type:"text"},domProps:{value:e.form.purpose},on:{input:function(t){t.target.composing||e.$set(e.form,"purpose",t.target.value)}}}),e._v(" "),n("div",{staticStyle:{position:"absolute",top:"0",right:"0",width:"0.8rem",height:"0.7rem"},on:{click:function(t){e.choosingPurpose=!e.choosingPurpose}}},[n("i",{staticClass:"blackArrow_icon positionIcon",style:{"margin-top":e.choosingPurpose?"-0.1rem":"-0.12rem",transform:e.choosingPurpose?"rotate(90deg)":"rotate(0deg)"}})]),e._v(" "),n("div",{staticStyle:{width:"100%",position:"absolute",top:"0.9rem",left:"0","z-index":"1"}},[n("JcSelect",{directives:[{name:"show",rawName:"v-show",value:e.choosingPurpose,expression:"choosingPurpose"}],staticStyle:{color:"#616569"},attrs:{data:e.purposeList,width:"100%",borderColor:"#559df7",align:"left",fontSize:"0.28rem"},on:{close:function(t){e.choosingPurpose=!1}},model:{value:e.form.purpose,callback:function(t){e.$set(e.form,"purpose",t)},expression:"form.purpose"}})],1)])]),e._v(" "),n("li",{staticStyle:{"justify-content":"center"}},[n("button",{staticClass:"confirmBtn",class:{confirm_Btn:e.checkInput},on:{click:function(t){e.confirmDialog=!0}}},[e._v(e._s(e.$t("message.transferPayment.confirmPay")))])])]),e._v(" "),n("van-dialog",{attrs:{"show-confirm-button":!1,title:e.$t("message.transferPayment.payments.inputPassword")},model:{value:e.confirmDialog,callback:function(t){e.confirmDialog=t},expression:"confirmDialog"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.tradePsw,expression:"form.tradePsw"}],staticClass:"inputPsw",staticStyle:{"margin-top":"0.1rem"},attrs:{type:"password",placeholder:e.$t("message.transferPayment.payments.inputPassword")},domProps:{value:e.form.tradePsw},on:{input:function(t){t.target.composing||e.$set(e.form,"tradePsw",t.target.value)}}}),e._v(" "),n("div",[n("button",{staticClass:"inputPsw",staticStyle:{margin:"0.4rem 0 0.2rem 0",background:"#409EFF",color:"#fff","font-size":"0.28rem"},on:{click:e.confirmPay}},[e._v(e._s(e.$t("message.transferPayment.comfirmAgiotagePay")))])])])],1)},staticRenderFns:[]};var _=n("VU/8")(P,C,!1,function(e){n("qku6")},"data-v-88d623c2",null);t.default=_.exports},qku6:function(e,t){}});
//# sourceMappingURL=10.4c07644e233b888ba664.js.map